CREATE DATABASE rootdb;
\c rootdb;

CREATE USER root WITH PASSWORD 'root';
GRANT ALL PRIVILEGES ON DATABASE rootdb TO root;
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO root;

CREATE TABLE IF NOT EXISTS public.students (
    id          INT             GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME        VARCHAR(255)    NOT NULL,
    COURSE      VARCHAR(255)    NOT NULL
);

CREATE TABLE IF NOT EXISTS public.emails (
    ID      INT            GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email   varchar(255)    NOT NULL UNIQUE,
    STUDENT_ID    INT    REFERENCES STUDENTS(ID)
);

INSERT INTO STUDENTS (ID,NAME,COURSE) VALUES (1,'AAAA',1) ON CONFLICT DO NOTHING;;
INSERT INTO STUDENTS (ID,NAME,COURSE) VALUES (2,'bbbb',2) ON CONFLICT DO NOTHING;;
INSERT INTO STUDENTS (ID,NAME,COURSE) VALUES (3,'CCCC',1) ON CONFLICT DO NOTHING;;
INSERT INTO STUDENTS (ID,NAME,COURSE) VALUES (3,'CCCC2',1) ON CONFLICT DO NOTHING;

INSERT INTO EMAILS (EMAIL,STUDENT_ID) VALUES ('AAAA@YANDEX.RU',1) ON CONFLICT DO NOTHING;;
INSERT INTO EMAILS (EMAIL,STUDENT_ID) VALUES ('bbbb@YANDEX.RU',2) ON CONFLICT DO NOTHING;;
INSERT INTO EMAILS (EMAIL,STUDENT_ID) VALUES ('CCCCC@YANDEX.RU',3) ON CONFLICT DO NOTHING;;
INSERT INTO EMAILS (EMAIL,STUDENT_ID) VALUES ('AAAAA@YANDEX.RU',1) ON CONFLICT DO NOTHING;;

GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO root;
